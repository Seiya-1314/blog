(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{349:function(t,s,e){t.exports=e.p+"assets/img/3.b422df1c.png"},350:function(t,s,e){t.exports=e.p+"assets/img/4.3cb2861b.png"},351:function(t,s,e){t.exports=e.p+"assets/img/5.03164b21.png"},352:function(t,s,e){t.exports=e.p+"assets/img/6.bad428d5.png"},379:function(t,s,e){"use strict";e.r(s);var a=[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"webpack-使用-scope-hoisting"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack-使用-scope-hoisting","aria-hidden":"true"}},[this._v("#")]),this._v(" webpack 使用 scope hoisting")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"构建的现状"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建的现状","aria-hidden":"true"}},[this._v("#")]),this._v(" 构建的现状")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:e(349),alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("p",[s("strong",[this._v("大量函数闭包包裹代码，导致体积增大（模块越多越明显）；")])])]),this._v(" "),s("li",[s("p",[s("strong",[this._v("运行代码时创建的函数作用域变多，内存开销变大；")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"模块转换分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模块转换分析","aria-hidden":"true"}},[this._v("#")]),this._v(" 模块转换分析")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:e(350),alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:e(351),alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"scope-hoisting-原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#scope-hoisting-原理","aria-hidden":"true"}},[this._v("#")]),this._v(" scope hoisting 原理")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:e(352),alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("我们可以看到，"),s("strong",[this._v("scope-hoisting 可以减少函数声明代码和内存开销。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"使用-scope-hoisting"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-scope-hoisting","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用 scope-hoisting")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\tplugins"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("webpack"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("optimize"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ModuleConcatenationPlugin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("注意：")]),this._v(" "),s("p",[this._v("必须是 ES6 语法，CommonJS 规范不支持，因为动态引入没办法进行静态分析。")])])}],r=e(0),n=Object(r.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),e("br"),t._v(" "),e("author",{attrs:{time:"2019年07月16日"}}),t._v(" "),e("br"),t._v(" "),t._m(1),t._v(" "),e("br"),t._v(" "),e("p",[t._v("构建后的代码存在⼤量闭包代码，如下图所示：")]),t._v(" "),t._m(2),t._v(" "),e("br"),t._v(" "),e("p",[t._v("这样导致了两个问题：")]),t._v(" "),t._m(3),t._v(" "),e("br"),t._v(" "),e("br"),t._v(" "),t._m(4),t._v(" "),e("br"),t._v(" "),t._m(5),t._v(" "),e("p",[t._v("拿上图进行分析，从 webpack 打包完成输出的文件中可以看出，模块被包裹转化为初始化的函数，然后 import 会被转换成 __webpack_require。这样能够在绝大部分浏览器中运行。")]),t._v(" "),e("br"),t._v(" "),e("p",[t._v("整个 webpack 的模块机制如下图所示：")]),t._v(" "),t._m(6),t._v(" "),e("br"),t._v(" "),e("br"),t._v(" "),t._m(7),t._v(" "),e("br"),t._v(" "),e("p",[e("font",{attrs:{color:"red"}},[e("strong",[t._v("将所有模块的代码按照引用顺序放在一个函数作用域⾥，然后适当的重命名一些变量以防止变量名冲突。")])])],1),t._v(" "),e("p",[t._v("举例来讲：如果在模块 A 中引用了模块 B，scope-hoisting 可以根据模块的引入顺序进行排放，也就是将模块 B 放在模块 A 前面，这样就减少了包裹的代码，如下图所示：")]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),e("br"),t._v(" "),e("br"),t._v(" "),t._m(10),t._v(" "),e("br"),t._v(" "),e("p",[t._v("webpack mode 配置为 production 时默认开启 scope-hoisting 功能，我们也可手动引入，具体配置如下：")]),t._v(" "),t._m(11),e("br"),t._v(" "),t._m(12)],1)},a,!1,null,null,null);s.default=n.exports}}]);