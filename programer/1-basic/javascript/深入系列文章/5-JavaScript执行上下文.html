<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>深入JavaScript执行上下文 | Blog</title>
    <meta name="description" content="执行上下文(简称-EC)是ECMA-262标准里的一个抽象概念，用于同可执行代码(executable code)概念进行区分。标准规范没有从技术实现的角度定义 EC 的准确类型和结构，这应该是具体实现 ECMAScript 引擎时要考虑的问题。">
    <link rel="icon" href="/blog/icon.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <meta name="keywords" content="JavaScript,javascript,预编译,上下文,环境,执行上下文,作用域链,this,变量对象,活动对象,上下文栈,VO,AO,scope">
    <link rel="preload" href="/blog/assets/css/0.styles.511ec017.css" as="style"><link rel="preload" href="/blog/assets/js/app.39887082.js" as="script"><link rel="preload" href="/blog/assets/js/12.f5e2c995.js" as="script"><link rel="preload" href="/blog/assets/js/66.a0b0e699.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.8d62a5d5.js"><link rel="prefetch" href="/blog/assets/js/100.40550fa8.js"><link rel="prefetch" href="/blog/assets/js/101.d1feb1c2.js"><link rel="prefetch" href="/blog/assets/js/102.769cf919.js"><link rel="prefetch" href="/blog/assets/js/103.de2faa5f.js"><link rel="prefetch" href="/blog/assets/js/104.a2489fe7.js"><link rel="prefetch" href="/blog/assets/js/105.dee5e421.js"><link rel="prefetch" href="/blog/assets/js/106.900b4cf4.js"><link rel="prefetch" href="/blog/assets/js/107.a3012e6e.js"><link rel="prefetch" href="/blog/assets/js/108.9168cb14.js"><link rel="prefetch" href="/blog/assets/js/109.2aae8fa4.js"><link rel="prefetch" href="/blog/assets/js/11.f516668d.js"><link rel="prefetch" href="/blog/assets/js/110.ea6bce15.js"><link rel="prefetch" href="/blog/assets/js/111.0d610899.js"><link rel="prefetch" href="/blog/assets/js/112.00965329.js"><link rel="prefetch" href="/blog/assets/js/113.9452cabc.js"><link rel="prefetch" href="/blog/assets/js/114.da288081.js"><link rel="prefetch" href="/blog/assets/js/115.992ca78d.js"><link rel="prefetch" href="/blog/assets/js/116.fc2ddb04.js"><link rel="prefetch" href="/blog/assets/js/117.3af76a15.js"><link rel="prefetch" href="/blog/assets/js/118.b22d8c65.js"><link rel="prefetch" href="/blog/assets/js/119.7fe9cbd5.js"><link rel="prefetch" href="/blog/assets/js/120.13f71485.js"><link rel="prefetch" href="/blog/assets/js/121.dabefc5a.js"><link rel="prefetch" href="/blog/assets/js/122.01a37a18.js"><link rel="prefetch" href="/blog/assets/js/123.3c5e3ba4.js"><link rel="prefetch" href="/blog/assets/js/124.f438a187.js"><link rel="prefetch" href="/blog/assets/js/125.8584f7f0.js"><link rel="prefetch" href="/blog/assets/js/126.b91c9d11.js"><link rel="prefetch" href="/blog/assets/js/127.b7d28af7.js"><link rel="prefetch" href="/blog/assets/js/128.2902b500.js"><link rel="prefetch" href="/blog/assets/js/129.af6579af.js"><link rel="prefetch" href="/blog/assets/js/13.ac13bac9.js"><link rel="prefetch" href="/blog/assets/js/130.79cf6630.js"><link rel="prefetch" href="/blog/assets/js/131.84faa2eb.js"><link rel="prefetch" href="/blog/assets/js/132.2742e7a8.js"><link rel="prefetch" href="/blog/assets/js/133.50d1603f.js"><link rel="prefetch" href="/blog/assets/js/134.eec917e9.js"><link rel="prefetch" href="/blog/assets/js/135.82e6f298.js"><link rel="prefetch" href="/blog/assets/js/136.5cdc95f2.js"><link rel="prefetch" href="/blog/assets/js/137.c57aa7c1.js"><link rel="prefetch" href="/blog/assets/js/138.03caeffa.js"><link rel="prefetch" href="/blog/assets/js/139.4c979783.js"><link rel="prefetch" href="/blog/assets/js/14.d11612a0.js"><link rel="prefetch" href="/blog/assets/js/140.49fe24b3.js"><link rel="prefetch" href="/blog/assets/js/141.f3a4768e.js"><link rel="prefetch" href="/blog/assets/js/142.b1994450.js"><link rel="prefetch" href="/blog/assets/js/143.48508e9d.js"><link rel="prefetch" href="/blog/assets/js/144.d3c779c4.js"><link rel="prefetch" href="/blog/assets/js/145.e29ed321.js"><link rel="prefetch" href="/blog/assets/js/146.0a67773b.js"><link rel="prefetch" href="/blog/assets/js/147.3724a0f3.js"><link rel="prefetch" href="/blog/assets/js/148.3abbbc37.js"><link rel="prefetch" href="/blog/assets/js/149.d733d2c8.js"><link rel="prefetch" href="/blog/assets/js/15.708d7056.js"><link rel="prefetch" href="/blog/assets/js/150.daf345ef.js"><link rel="prefetch" href="/blog/assets/js/151.a35c7ba2.js"><link rel="prefetch" href="/blog/assets/js/152.d840f8be.js"><link rel="prefetch" href="/blog/assets/js/153.05bb9ad4.js"><link rel="prefetch" href="/blog/assets/js/154.1700d777.js"><link rel="prefetch" href="/blog/assets/js/155.a9484326.js"><link rel="prefetch" href="/blog/assets/js/156.1af7a971.js"><link rel="prefetch" href="/blog/assets/js/157.b15abf15.js"><link rel="prefetch" href="/blog/assets/js/158.c643fe19.js"><link rel="prefetch" href="/blog/assets/js/159.b44de908.js"><link rel="prefetch" href="/blog/assets/js/16.2729673c.js"><link rel="prefetch" href="/blog/assets/js/160.83536c74.js"><link rel="prefetch" href="/blog/assets/js/161.9a56b076.js"><link rel="prefetch" href="/blog/assets/js/162.44cf24dd.js"><link rel="prefetch" href="/blog/assets/js/163.08ada04c.js"><link rel="prefetch" href="/blog/assets/js/164.62336204.js"><link rel="prefetch" href="/blog/assets/js/165.d312a799.js"><link rel="prefetch" href="/blog/assets/js/166.7308429c.js"><link rel="prefetch" href="/blog/assets/js/167.8d6da0df.js"><link rel="prefetch" href="/blog/assets/js/168.a47e1b46.js"><link rel="prefetch" href="/blog/assets/js/169.b624c020.js"><link rel="prefetch" href="/blog/assets/js/17.d3d6c4f8.js"><link rel="prefetch" href="/blog/assets/js/170.d47d6900.js"><link rel="prefetch" href="/blog/assets/js/171.6f9ef670.js"><link rel="prefetch" href="/blog/assets/js/172.761646f1.js"><link rel="prefetch" href="/blog/assets/js/173.eaef8eaa.js"><link rel="prefetch" href="/blog/assets/js/174.2b8425b9.js"><link rel="prefetch" href="/blog/assets/js/175.cdf21dca.js"><link rel="prefetch" href="/blog/assets/js/176.7dda6e4d.js"><link rel="prefetch" href="/blog/assets/js/177.dfed2dc8.js"><link rel="prefetch" href="/blog/assets/js/178.2a2b85a6.js"><link rel="prefetch" href="/blog/assets/js/179.0862e584.js"><link rel="prefetch" href="/blog/assets/js/18.a97ae1db.js"><link rel="prefetch" href="/blog/assets/js/180.50358b32.js"><link rel="prefetch" href="/blog/assets/js/181.0c2760a8.js"><link rel="prefetch" href="/blog/assets/js/182.86d76543.js"><link rel="prefetch" href="/blog/assets/js/183.34dc50b6.js"><link rel="prefetch" href="/blog/assets/js/184.23cc3cc8.js"><link rel="prefetch" href="/blog/assets/js/185.dde44252.js"><link rel="prefetch" href="/blog/assets/js/186.cea67f39.js"><link rel="prefetch" href="/blog/assets/js/187.db391050.js"><link rel="prefetch" href="/blog/assets/js/188.b40d981f.js"><link rel="prefetch" href="/blog/assets/js/189.b995db74.js"><link rel="prefetch" href="/blog/assets/js/19.8bf3d8ee.js"><link rel="prefetch" href="/blog/assets/js/190.f1f30722.js"><link rel="prefetch" href="/blog/assets/js/191.afec7ed4.js"><link rel="prefetch" href="/blog/assets/js/192.309ca80c.js"><link rel="prefetch" href="/blog/assets/js/193.f3997ce9.js"><link rel="prefetch" href="/blog/assets/js/194.9579f1fe.js"><link rel="prefetch" href="/blog/assets/js/195.063b2670.js"><link rel="prefetch" href="/blog/assets/js/196.a39c4829.js"><link rel="prefetch" href="/blog/assets/js/197.3f6cd84d.js"><link rel="prefetch" href="/blog/assets/js/198.3d4f8322.js"><link rel="prefetch" href="/blog/assets/js/199.6921f0c6.js"><link rel="prefetch" href="/blog/assets/js/2.710a66ec.js"><link rel="prefetch" href="/blog/assets/js/20.e68ded11.js"><link rel="prefetch" href="/blog/assets/js/200.18db6175.js"><link rel="prefetch" href="/blog/assets/js/201.c087aa4c.js"><link rel="prefetch" href="/blog/assets/js/202.7752d54e.js"><link rel="prefetch" href="/blog/assets/js/203.a8dba60a.js"><link rel="prefetch" href="/blog/assets/js/204.e1fcdcbb.js"><link rel="prefetch" href="/blog/assets/js/205.1c5a9612.js"><link rel="prefetch" href="/blog/assets/js/206.763c3a12.js"><link rel="prefetch" href="/blog/assets/js/207.02100c3e.js"><link rel="prefetch" href="/blog/assets/js/208.77e8d0f4.js"><link rel="prefetch" href="/blog/assets/js/209.64c48380.js"><link rel="prefetch" href="/blog/assets/js/21.4d387efc.js"><link rel="prefetch" href="/blog/assets/js/210.5a8b5faa.js"><link rel="prefetch" href="/blog/assets/js/211.059ecff7.js"><link rel="prefetch" href="/blog/assets/js/212.03e7aab2.js"><link rel="prefetch" href="/blog/assets/js/213.7e47b762.js"><link rel="prefetch" href="/blog/assets/js/214.721fa60b.js"><link rel="prefetch" href="/blog/assets/js/215.6c3aa9eb.js"><link rel="prefetch" href="/blog/assets/js/216.76898a2b.js"><link rel="prefetch" href="/blog/assets/js/217.b7f85c60.js"><link rel="prefetch" href="/blog/assets/js/218.cf553201.js"><link rel="prefetch" href="/blog/assets/js/219.7da67d6c.js"><link rel="prefetch" href="/blog/assets/js/22.670c2088.js"><link rel="prefetch" href="/blog/assets/js/220.05befb7a.js"><link rel="prefetch" href="/blog/assets/js/221.dc859d5b.js"><link rel="prefetch" href="/blog/assets/js/222.14e7a92b.js"><link rel="prefetch" href="/blog/assets/js/223.afc8cad1.js"><link rel="prefetch" href="/blog/assets/js/224.46829572.js"><link rel="prefetch" href="/blog/assets/js/225.3e4a1230.js"><link rel="prefetch" href="/blog/assets/js/226.66af8b18.js"><link rel="prefetch" href="/blog/assets/js/227.c09e666e.js"><link rel="prefetch" href="/blog/assets/js/228.15b395f0.js"><link rel="prefetch" href="/blog/assets/js/229.8901c547.js"><link rel="prefetch" href="/blog/assets/js/23.13e465e1.js"><link rel="prefetch" href="/blog/assets/js/230.7fdee682.js"><link rel="prefetch" href="/blog/assets/js/231.bdb7e1d3.js"><link rel="prefetch" href="/blog/assets/js/232.b655b3b7.js"><link rel="prefetch" href="/blog/assets/js/233.12132f03.js"><link rel="prefetch" href="/blog/assets/js/234.d8de2562.js"><link rel="prefetch" href="/blog/assets/js/235.c69fb4d8.js"><link rel="prefetch" href="/blog/assets/js/236.d6287825.js"><link rel="prefetch" href="/blog/assets/js/237.30947495.js"><link rel="prefetch" href="/blog/assets/js/238.7cf936c4.js"><link rel="prefetch" href="/blog/assets/js/239.4a5db3b1.js"><link rel="prefetch" href="/blog/assets/js/24.41d599f9.js"><link rel="prefetch" href="/blog/assets/js/240.53ef9cc2.js"><link rel="prefetch" href="/blog/assets/js/241.b369e26b.js"><link rel="prefetch" href="/blog/assets/js/242.85e0aef0.js"><link rel="prefetch" href="/blog/assets/js/243.bb9261b0.js"><link rel="prefetch" href="/blog/assets/js/244.5d8cae46.js"><link rel="prefetch" href="/blog/assets/js/245.74b7721f.js"><link rel="prefetch" href="/blog/assets/js/246.7ee545e6.js"><link rel="prefetch" href="/blog/assets/js/247.88716eb3.js"><link rel="prefetch" href="/blog/assets/js/248.4e13bc0d.js"><link rel="prefetch" href="/blog/assets/js/249.62071145.js"><link rel="prefetch" href="/blog/assets/js/25.a7949d32.js"><link rel="prefetch" href="/blog/assets/js/250.457666ff.js"><link rel="prefetch" href="/blog/assets/js/251.3079434c.js"><link rel="prefetch" href="/blog/assets/js/252.e8f8da3b.js"><link rel="prefetch" href="/blog/assets/js/253.3251fdfe.js"><link rel="prefetch" href="/blog/assets/js/254.700d2743.js"><link rel="prefetch" href="/blog/assets/js/255.7b6c1da5.js"><link rel="prefetch" href="/blog/assets/js/256.18f53290.js"><link rel="prefetch" href="/blog/assets/js/257.cdc1c5e7.js"><link rel="prefetch" href="/blog/assets/js/258.bb726298.js"><link rel="prefetch" href="/blog/assets/js/259.c81a13dd.js"><link rel="prefetch" href="/blog/assets/js/26.f448418e.js"><link rel="prefetch" href="/blog/assets/js/260.41fb2180.js"><link rel="prefetch" href="/blog/assets/js/261.7a1a8351.js"><link rel="prefetch" href="/blog/assets/js/262.d599101a.js"><link rel="prefetch" href="/blog/assets/js/263.e6edd655.js"><link rel="prefetch" href="/blog/assets/js/264.be1b8dd0.js"><link rel="prefetch" href="/blog/assets/js/265.ddbb93d7.js"><link rel="prefetch" href="/blog/assets/js/266.8027398c.js"><link rel="prefetch" href="/blog/assets/js/267.6f051335.js"><link rel="prefetch" href="/blog/assets/js/268.c5988930.js"><link rel="prefetch" href="/blog/assets/js/269.6a6f353a.js"><link rel="prefetch" href="/blog/assets/js/27.cd624f4c.js"><link rel="prefetch" href="/blog/assets/js/270.544561e9.js"><link rel="prefetch" href="/blog/assets/js/271.b1561dd9.js"><link rel="prefetch" href="/blog/assets/js/272.10359eae.js"><link rel="prefetch" href="/blog/assets/js/273.b627d5cc.js"><link rel="prefetch" href="/blog/assets/js/274.74314ec3.js"><link rel="prefetch" href="/blog/assets/js/275.9521e88d.js"><link rel="prefetch" href="/blog/assets/js/276.261937a2.js"><link rel="prefetch" href="/blog/assets/js/277.297e9778.js"><link rel="prefetch" href="/blog/assets/js/278.ac64542c.js"><link rel="prefetch" href="/blog/assets/js/279.4687315d.js"><link rel="prefetch" href="/blog/assets/js/28.409853ea.js"><link rel="prefetch" href="/blog/assets/js/280.323eda42.js"><link rel="prefetch" href="/blog/assets/js/281.6e0bb75f.js"><link rel="prefetch" href="/blog/assets/js/282.c3ba3826.js"><link rel="prefetch" href="/blog/assets/js/283.38f0f832.js"><link rel="prefetch" href="/blog/assets/js/284.8f2b2d17.js"><link rel="prefetch" href="/blog/assets/js/285.5847bf94.js"><link rel="prefetch" href="/blog/assets/js/286.139526d0.js"><link rel="prefetch" href="/blog/assets/js/287.4c0b3cef.js"><link rel="prefetch" href="/blog/assets/js/288.84a1a254.js"><link rel="prefetch" href="/blog/assets/js/289.2299bf11.js"><link rel="prefetch" href="/blog/assets/js/29.b9809813.js"><link rel="prefetch" href="/blog/assets/js/290.351a1d26.js"><link rel="prefetch" href="/blog/assets/js/291.2a24c09a.js"><link rel="prefetch" href="/blog/assets/js/292.513464a3.js"><link rel="prefetch" href="/blog/assets/js/293.2137cca4.js"><link rel="prefetch" href="/blog/assets/js/294.fffdcdcc.js"><link rel="prefetch" href="/blog/assets/js/295.43bee520.js"><link rel="prefetch" href="/blog/assets/js/296.5a1110bc.js"><link rel="prefetch" href="/blog/assets/js/297.6a44973c.js"><link rel="prefetch" href="/blog/assets/js/298.c0e64037.js"><link rel="prefetch" href="/blog/assets/js/299.078804a7.js"><link rel="prefetch" href="/blog/assets/js/3.f3c7737a.js"><link rel="prefetch" href="/blog/assets/js/30.1ebcadc9.js"><link rel="prefetch" href="/blog/assets/js/300.28949535.js"><link rel="prefetch" href="/blog/assets/js/301.25dfd108.js"><link rel="prefetch" href="/blog/assets/js/302.04b54249.js"><link rel="prefetch" href="/blog/assets/js/303.f65cb3d9.js"><link rel="prefetch" href="/blog/assets/js/304.0e456f23.js"><link rel="prefetch" href="/blog/assets/js/305.632ba783.js"><link rel="prefetch" href="/blog/assets/js/306.8ec5ec6f.js"><link rel="prefetch" href="/blog/assets/js/307.5f780520.js"><link rel="prefetch" href="/blog/assets/js/308.496a7426.js"><link rel="prefetch" href="/blog/assets/js/309.5340f2bf.js"><link rel="prefetch" href="/blog/assets/js/31.357acc50.js"><link rel="prefetch" href="/blog/assets/js/310.75448bbe.js"><link rel="prefetch" href="/blog/assets/js/311.8e69405c.js"><link rel="prefetch" href="/blog/assets/js/312.a2f9a614.js"><link rel="prefetch" href="/blog/assets/js/313.911e5817.js"><link rel="prefetch" href="/blog/assets/js/314.37b7ac1d.js"><link rel="prefetch" href="/blog/assets/js/315.ecb8c705.js"><link rel="prefetch" href="/blog/assets/js/316.a226cace.js"><link rel="prefetch" href="/blog/assets/js/317.9d29f704.js"><link rel="prefetch" href="/blog/assets/js/318.eeea8523.js"><link rel="prefetch" href="/blog/assets/js/319.9e692cb6.js"><link rel="prefetch" href="/blog/assets/js/32.2883af47.js"><link rel="prefetch" href="/blog/assets/js/320.1a4314f8.js"><link rel="prefetch" href="/blog/assets/js/321.6cee257b.js"><link rel="prefetch" href="/blog/assets/js/322.4ed153a9.js"><link rel="prefetch" href="/blog/assets/js/323.d08b22df.js"><link rel="prefetch" href="/blog/assets/js/324.543cc5d3.js"><link rel="prefetch" href="/blog/assets/js/325.3b689f75.js"><link rel="prefetch" href="/blog/assets/js/33.8a991593.js"><link rel="prefetch" href="/blog/assets/js/34.8f405b18.js"><link rel="prefetch" href="/blog/assets/js/35.85dc6ad0.js"><link rel="prefetch" href="/blog/assets/js/36.334d2820.js"><link rel="prefetch" href="/blog/assets/js/37.5635d66f.js"><link rel="prefetch" href="/blog/assets/js/38.da422504.js"><link rel="prefetch" href="/blog/assets/js/39.9065fb1f.js"><link rel="prefetch" href="/blog/assets/js/4.bd663a0f.js"><link rel="prefetch" href="/blog/assets/js/40.49a38102.js"><link rel="prefetch" href="/blog/assets/js/41.99219a8a.js"><link rel="prefetch" href="/blog/assets/js/42.9deba258.js"><link rel="prefetch" href="/blog/assets/js/43.bf3d34cc.js"><link rel="prefetch" href="/blog/assets/js/44.3f32996e.js"><link rel="prefetch" href="/blog/assets/js/45.d4a55e74.js"><link rel="prefetch" href="/blog/assets/js/46.05a08a80.js"><link rel="prefetch" href="/blog/assets/js/47.3e38598b.js"><link rel="prefetch" href="/blog/assets/js/48.2e9c3ea6.js"><link rel="prefetch" href="/blog/assets/js/49.1ca1c005.js"><link rel="prefetch" href="/blog/assets/js/5.c93f43b0.js"><link rel="prefetch" href="/blog/assets/js/50.4d3f00c1.js"><link rel="prefetch" href="/blog/assets/js/51.ea8551e8.js"><link rel="prefetch" href="/blog/assets/js/52.ad927f49.js"><link rel="prefetch" href="/blog/assets/js/53.e2a3e703.js"><link rel="prefetch" href="/blog/assets/js/54.5aa22d0d.js"><link rel="prefetch" href="/blog/assets/js/55.c2bad324.js"><link rel="prefetch" href="/blog/assets/js/56.8422a5c9.js"><link rel="prefetch" href="/blog/assets/js/57.bdd58bd7.js"><link rel="prefetch" href="/blog/assets/js/58.ee0a9517.js"><link rel="prefetch" href="/blog/assets/js/59.2af462a1.js"><link rel="prefetch" href="/blog/assets/js/6.b94078ac.js"><link rel="prefetch" href="/blog/assets/js/60.e885ba72.js"><link rel="prefetch" href="/blog/assets/js/61.c08b05f1.js"><link rel="prefetch" href="/blog/assets/js/62.ba3452ac.js"><link rel="prefetch" href="/blog/assets/js/63.bce62af9.js"><link rel="prefetch" href="/blog/assets/js/64.0bef7045.js"><link rel="prefetch" href="/blog/assets/js/65.66e6654e.js"><link rel="prefetch" href="/blog/assets/js/67.c18a5ac3.js"><link rel="prefetch" href="/blog/assets/js/68.ea9cef57.js"><link rel="prefetch" href="/blog/assets/js/69.2021cec2.js"><link rel="prefetch" href="/blog/assets/js/7.21125540.js"><link rel="prefetch" href="/blog/assets/js/70.8cd6664b.js"><link rel="prefetch" href="/blog/assets/js/71.0fc7d28a.js"><link rel="prefetch" href="/blog/assets/js/72.98471ee3.js"><link rel="prefetch" href="/blog/assets/js/73.e5fe0c76.js"><link rel="prefetch" href="/blog/assets/js/74.6b6cd52a.js"><link rel="prefetch" href="/blog/assets/js/75.5dd021dd.js"><link rel="prefetch" href="/blog/assets/js/76.1b7c78e8.js"><link rel="prefetch" href="/blog/assets/js/77.40a0eb4d.js"><link rel="prefetch" href="/blog/assets/js/78.bdeac015.js"><link rel="prefetch" href="/blog/assets/js/79.3db1f22a.js"><link rel="prefetch" href="/blog/assets/js/8.f792d71f.js"><link rel="prefetch" href="/blog/assets/js/80.a0c1c191.js"><link rel="prefetch" href="/blog/assets/js/81.73fb109d.js"><link rel="prefetch" href="/blog/assets/js/82.02279f28.js"><link rel="prefetch" href="/blog/assets/js/83.066e0728.js"><link rel="prefetch" href="/blog/assets/js/84.1896275c.js"><link rel="prefetch" href="/blog/assets/js/85.f933720e.js"><link rel="prefetch" href="/blog/assets/js/86.ac14e7ba.js"><link rel="prefetch" href="/blog/assets/js/87.a7f98f52.js"><link rel="prefetch" href="/blog/assets/js/88.1b80b23b.js"><link rel="prefetch" href="/blog/assets/js/89.e349b1a9.js"><link rel="prefetch" href="/blog/assets/js/9.67dfc6fe.js"><link rel="prefetch" href="/blog/assets/js/90.5cb0f91e.js"><link rel="prefetch" href="/blog/assets/js/91.edb5ce05.js"><link rel="prefetch" href="/blog/assets/js/92.ed3339a0.js"><link rel="prefetch" href="/blog/assets/js/93.0d22df77.js"><link rel="prefetch" href="/blog/assets/js/94.38c2a576.js"><link rel="prefetch" href="/blog/assets/js/95.99ccbc44.js"><link rel="prefetch" href="/blog/assets/js/96.c15116f1.js"><link rel="prefetch" href="/blog/assets/js/97.6cc50155.js"><link rel="prefetch" href="/blog/assets/js/98.3137c72a.js"><link rel="prefetch" href="/blog/assets/js/99.fa91accf.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.511ec017.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Blog</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">读书</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/book/read/" class="nav-link">记录</a></li><li class="dropdown-item"><!----> <a href="/blog/book/notes/" class="nav-link">笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/programer/1-basic/css/" class="nav-link">css</a></li><li class="dropdown-subitem"><a href="/blog/programer/1-basic/javascript/" class="nav-link router-link-active">JavaScript</a></li><li class="dropdown-subitem"><a href="/blog/programer/1-basic/browser/" class="nav-link">浏览器</a></li><li class="dropdown-subitem"><a href="/blog/programer/1-basic/system/" class="nav-link">操作系统</a></li><li class="dropdown-subitem"><a href="/blog/programer/1-basic/network/" class="nav-link">计算机网络</a></li><li class="dropdown-subitem"><a href="/blog/programer/1-basic/organization/" class="nav-link">计算机组成原理</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/programer/2-frame/vue.js/" class="nav-link">Vue.js</a></li><li class="dropdown-subitem"><a href="/blog/programer/2-frame/mini-app/" class="nav-link">小程序</a></li></ul></li><li class="dropdown-item"><h4>工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/programer/3-tool/shell/" class="nav-link">shell</a></li><li class="dropdown-subitem"><a href="/blog/programer/3-tool/webpack/" class="nav-link">webpack</a></li><li class="dropdown-subitem"><a href="/blog/programer/3-tool/typescript/" class="nav-link">TypeScript</a></li></ul></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/programer/4-develop/php/" class="nav-link">php</a></li><li class="dropdown-subitem"><a href="/blog/programer/4-develop/node.js/" class="nav-link">node.js</a></li></ul></li><li class="dropdown-item"><h4>其它</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/programer/5-standard/standard/" class="nav-link">编码规范</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>经济学</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/hobby/economics/" class="nav-link">薛兆丰的经济学课</a></li></ul></li><li class="dropdown-item"><h4>统计学</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/hobby/statistics/描述统计学/" class="nav-link">描述统计学</a></li><li class="dropdown-subitem"><a href="/blog/hobby/statistics/统计学习方法/" class="nav-link">统计学习方法</a></li></ul></li><li class="dropdown-item"><h4>产品思维</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/hobby/product/梁宁产品思维三十讲/" class="nav-link">梁宁产品思维三十讲</a></li><li class="dropdown-subitem"><a href="/blog/hobby/product/梁宁增长思维三十讲/" class="nav-link">梁宁增长思维三十讲</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/Seiya-1314" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">读书</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/book/read/" class="nav-link">记录</a></li><li class="dropdown-item"><!----> <a href="/blog/book/notes/" class="nav-link">笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/programer/1-basic/css/" class="nav-link">css</a></li><li class="dropdown-subitem"><a href="/blog/programer/1-basic/javascript/" class="nav-link router-link-active">JavaScript</a></li><li class="dropdown-subitem"><a href="/blog/programer/1-basic/browser/" class="nav-link">浏览器</a></li><li class="dropdown-subitem"><a href="/blog/programer/1-basic/system/" class="nav-link">操作系统</a></li><li class="dropdown-subitem"><a href="/blog/programer/1-basic/network/" class="nav-link">计算机网络</a></li><li class="dropdown-subitem"><a href="/blog/programer/1-basic/organization/" class="nav-link">计算机组成原理</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/programer/2-frame/vue.js/" class="nav-link">Vue.js</a></li><li class="dropdown-subitem"><a href="/blog/programer/2-frame/mini-app/" class="nav-link">小程序</a></li></ul></li><li class="dropdown-item"><h4>工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/programer/3-tool/shell/" class="nav-link">shell</a></li><li class="dropdown-subitem"><a href="/blog/programer/3-tool/webpack/" class="nav-link">webpack</a></li><li class="dropdown-subitem"><a href="/blog/programer/3-tool/typescript/" class="nav-link">TypeScript</a></li></ul></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/programer/4-develop/php/" class="nav-link">php</a></li><li class="dropdown-subitem"><a href="/blog/programer/4-develop/node.js/" class="nav-link">node.js</a></li></ul></li><li class="dropdown-item"><h4>其它</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/programer/5-standard/standard/" class="nav-link">编码规范</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>经济学</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/hobby/economics/" class="nav-link">薛兆丰的经济学课</a></li></ul></li><li class="dropdown-item"><h4>统计学</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/hobby/statistics/描述统计学/" class="nav-link">描述统计学</a></li><li class="dropdown-subitem"><a href="/blog/hobby/statistics/统计学习方法/" class="nav-link">统计学习方法</a></li></ul></li><li class="dropdown-item"><h4>产品思维</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/hobby/product/梁宁产品思维三十讲/" class="nav-link">梁宁产品思维三十讲</a></li><li class="dropdown-subitem"><a href="/blog/hobby/product/梁宁增长思维三十讲/" class="nav-link">梁宁增长思维三十讲</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/Seiya-1314" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>深入JavaScript执行上下文</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/5-JavaScript%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html#前言" class="sidebar-link">前言</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/5-JavaScript%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html#执行上下文" class="sidebar-link">执行上下文</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/5-JavaScript%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html#执行上下文栈" class="sidebar-link">执行上下文栈</a></li><li class="sidebar-sub-header"><a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/5-JavaScript%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html#可执行代码类型" class="sidebar-link">可执行代码类型</a></li></ul></li><li><a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/5-JavaScript%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html#执行上下文结构" class="sidebar-link">执行上下文结构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/5-JavaScript%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html#变量对象" class="sidebar-link">变量对象</a></li><li class="sidebar-sub-header"><a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/5-JavaScript%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html#活动对象" class="sidebar-link">活动对象</a></li><li class="sidebar-sub-header"><a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/5-JavaScript%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html#作用域链" class="sidebar-link">作用域链</a></li><li class="sidebar-sub-header"><a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/5-JavaScript%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html#this指向" class="sidebar-link">this指向</a></li></ul></li><li><a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/5-JavaScript%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html#示例" class="sidebar-link">示例</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="深入javascript执行上下文"><a href="#深入javascript执行上下文" aria-hidden="true" class="header-anchor">#</a> 深入JavaScript执行上下文</h1> <br> <div><p><font color="gray">作者：Seiya</font></p> <p><font color="gray">时间：2019年06月04日</font></p> <!----></div> <br> <h2 id="前言"><a href="#前言" aria-hidden="true" class="header-anchor">#</a> 前言</h2> <br> <p>上一篇文章 <a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/4-JavaScript预编译流程.html">《理解 JavaScript 编译执行流程》</a>的示例中，我们可以大概了解到 JavaScript 代码编译执行的过程。对于 JavaScript 来说，大部分情况下编译发生在代码执行前的几微秒（甚至更短！）的时间内。简单地说，任何 JavaScript 代码片段在执行前都要进行编译（通常就在执行前）。</p> <p>JavaScript 引擎在编译 JavaScript 代码时，除了前面<a href="/blog/programer/1-basic/javascript/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/3-V8引擎工作原理.html">《理解 JavaScript 编译执行流程》</a>提到的编译器的工作外，还会<strong>创建执行上下文</strong>，下面我们会具体进行解释。</p> <br> <br> <h2 id="执行上下文"><a href="#执行上下文" aria-hidden="true" class="header-anchor">#</a> 执行上下文</h2> <br> <p>执行上下文(简称-EC)是ECMA-262标准里的一个抽象概念，用于同可执行代码(executable code)概念进行区分。标准规范没有从技术实现的角度定义 EC 的准确类型和结构，这应该是具体实现 ECMAScript 引擎时要考虑的问题。</p> <br> <h3 id="执行上下文栈"><a href="#执行上下文栈" aria-hidden="true" class="header-anchor">#</a> 执行上下文栈</h3> <br> <p>一个执行上下文可以激活另一个上下文，就好比一个函数调用了另一个函数，然后一层一层调用下去。逻辑上来说，这种实现方式是栈，我们可以称之为上下文堆栈(ECStack)。堆栈底部永远都是全局上下文(global context)，而顶部就是当前(活动的)执行上下文。堆栈在EC类型进入和退出上下文的时候被修改（推入或弹出）。</p> <p>激活其它上下文的某个上下文被称为调用者(caller) 。被激活的上下文被称为被调用者(callee) ，被调用者同时也可能是调用者。</p> <br> <p>当一段程序开始时，会先进入全局执行上下文环境 <code>[global execution context]</code>, 这个也是堆栈中最底部的元素。此全局程序会开始初始化，初始化生成必要的对象 <code>[objects]</code> 和函数 <code>[functions]</code>。在此全局上下文执行的过程中，它可能会激活一些方法（当然是已经初始化过的），然后进入他们的上下文环境，然后将新的元素压入堆栈。在这些初始化都结束之后，这个系统会等待一些事件（例如用户的鼠标点击等），会触发一些方法，然后进入一个新的上下文环境。</p> <br> <h3 id="可执行代码类型"><a href="#可执行代码类型" aria-hidden="true" class="header-anchor">#</a> 可执行代码类型</h3> <p>可执行代码的类型这个概念与执行上下文的抽象概念是有关系的。在某些时刻，可执行代码与执行上下文完全有可能是等价的。下面我们举例介绍三种可执行代码类型：</p> <br> <ul><li><p><strong><code>类型一</code></strong>：<strong>全局代码(global)</strong></p> <p>这种类型的代码是在&quot;程序&quot;级处理的：例如加载外部的js文件或者本地 <code>&lt;script&gt;</code> 标签内的代码。全局代码不包括任何function体内的代码。</p> <p>在初始化（程序启动）阶段，ECStack是这样的：</p> <div class="language-js extra-class"><pre class="language-js"><code>ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
  globalContext
<span class="token punctuation">]</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>类型二</code></strong>：<strong>函数代码(function)</strong></p> <p>当进入 funtion 函数代码(所有类型的funtions)的时候，ECStack 被压入新元素。需要注意的是，具体的函数代码不包括内部函数(inner functions)代码。如下所示，我们使函数自己调自己的方式递归一次：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span>  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">bar</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>bar<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>那么，ECStack以如下方式被改变：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 第一次foo的激活调用</span>
ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token operator">&lt;</span>foo<span class="token operator">&gt;</span> functionContext
  globalContext
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// foo的递归激活调用</span>
ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token operator">&lt;</span>foo<span class="token operator">&gt;</span> functionContext – recursively
  <span class="token operator">&lt;</span>foo<span class="token operator">&gt;</span> functionContext
  globalContext
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>每次 return 的时候，都会退出当前执行上下文的，相应地ECStack就会弹出，栈指针会自动移动位置。一个抛出的异常如果没被截获的话也有可能从一个或多个执行上下文退出。相关代码执行完以后，ECStack只会包含全局上下文(global context)，一直到整个应用程序结束。</p></li></ul> <br> <ul><li><p><strong><code>类型三</code></strong>：<strong>eval代码(eval)</strong></p> <p>eval 有一个概念：调用上下文(calling context)。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'var x = 10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'var y = 20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10</span>
<span class="token function">alert</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;y&quot; 提示没有声明</span>
</code></pre></div><p>ECStack的变化过程：</p> <div class="language-js extra-class"><pre class="language-js"><code>ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
  globalContext
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// eval('var x = 10');</span>
ECStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
  evalContext<span class="token punctuation">,</span>
  callingContext<span class="token punctuation">:</span> globalContext
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// eval exited context</span>
ECStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// foo funciton call</span>
ECStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>foo<span class="token operator">&gt;</span> functionContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// eval('var y = 20');</span>
ECStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
  evalContext<span class="token punctuation">,</span>
  callingContext<span class="token punctuation">:</span> <span class="token operator">&lt;</span>foo<span class="token operator">&gt;</span> functionContext
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// eval执行完毕</span>
ECStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// foo执行完毕</span>
ECStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <br> <p>每一种代码的执行都需要依赖自身的上下文。当然global的上下文可能涵盖了很多的function和eval的实例。函数的每一次调用，都会进入函数执行中的上下文，并且来计算函数中变量等的值。eval函数的每一次执行，也会进入eval执行中的上下文，判断应该从何处获取变量的值。</p> <br> <br> <h2 id="执行上下文结构"><a href="#执行上下文结构" aria-hidden="true" class="header-anchor">#</a> 执行上下文结构</h2> <p>一个执行的上下文可以抽象的理解为object。每一个执行的上下文都有一系列的属性（我们称为上下文状态），他们用来追踪关联代码的执行进度。下图就是一个 context 的结构：</p> <p><img src="data:image/png;base64,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" alt></p> <p>实际上，在创建执行上下文的过程中，执行了以下三个过程：</p> <ul><li><p><strong>创建变量对象</strong></p></li> <li><p><strong>创建作用域链</strong></p></li> <li><p><strong>确定 this 指向</strong></p></li></ul> <p>下面我们就大概解释这三个过程：</p> <br> <h3 id="变量对象"><a href="#变量对象" aria-hidden="true" class="header-anchor">#</a> 变量对象</h3> <p><strong><code>变量对象</code>(Variable Object) 是与执行上下文相关的 <code>数据作用域</code>。它是与上下文关联的特殊对象，用于存储被定义在上下文中的 <code>变量</code> 和 <code>函数声明</code>。</strong></p> <div class="warning custom-block"><p class="custom-block-title">注意：</p> <p>函数表达式[function expression]是不包含在VO[variable object]里面的。</p></div> <br> <p>变量对象是一个抽象的概念，不同的上下文中，它表示使用不同的 object。例如，在 global 全局上下文中，变量对象也是全局对象自身[global object]（这就是我们可以通过全局对象的属性来指向全局变量）。举例如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>       <span class="token comment">// 函数声明</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 函数表达式</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>foo <span class="token operator">==</span> foo<span class="token punctuation">,</span>      <span class="token comment">// true</span>
  window<span class="token punctuation">.</span>bar <span class="token operator">==</span> bar     <span class="token comment">// true</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>baz<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 引用错误，baz没有被定义</span>
</code></pre></div><p>此时，全局上下文中的变量对象(VO)会有如下属性：</p> <p><img src="data:image/png;base64,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" alt></p> <p>如上所示，函数 <code>baz</code> 如果作为函数表达式则不被不被包含于变量对象。这就是在函数外部尝试访问产生引用错误(ReferenceError) 的原因。</p> <div class="warning custom-block"><p class="custom-block-title">注意：</p> <p>JavaScript 和其他语言相比(比如C/C++)，仅有函数能够创建新的作用域。在函数内部定义的变量与内部函数，在外部非直接可见并且不污染全局对象。使用 eval 的时候，我们同样会使用一个新的(eval创建)执行上下文。eval 会使用全局变量对象或调用者的变量对象(eval的调用来源)。</p></div> <p>那函数以及自身的变量对象又是怎样的呢？在一个函数上下文中，变量对象被表示为活动对象。</p> <br> <h3 id="活动对象"><a href="#活动对象" aria-hidden="true" class="header-anchor">#</a> 活动对象</h3> <p><strong><code>活动对象</code> (activation object) 在函数被调用者调用激活后被创建，它包含普通参数(formal parameters) 与特殊参数(arguments)对象(具有索引属性的参数映射表)。</strong></p> <div class="tip custom-block"><p class="custom-block-title">提示：</p> <p>活动对象在函数上下文中作为变量对象使用。除了函数的变量对象（存储变量与函数声明）保持不变之外，还包含以及特殊对象 <code>arguments</code> 。</p></div> <br> <p>下面我们举一个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> z <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>       <span class="token comment">// 函数声明</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 函数表达式</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>foo</code> 函数上下文的下一个激活对象(AO)如下图所示：</p> <p><img src="data:image/png;base64,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" alt></p> <br> <h3 id="作用域链"><a href="#作用域链" aria-hidden="true" class="header-anchor">#</a> 作用域链</h3> <p><strong><code>作用域链</code> 是一个对象列表(list of objects) ，用以检索上下文代码中出现的标识符(identifiers) 。</strong></p> <p>作用域链的原理和原型链很类似，如果这个变量在自己的作用域中没有，那么它会寻找父级的，直到最顶层。标示符[Identifiers]可以理解为变量名称、函数声明和普通参数。</p> <br> <p>在一般情况下，一个作用域链包括父级变量对象（作用域链的顶部）、函数自身变量VO和活动对象。不过，有些情况下也会包含其它的对象，例如在执行期间，动态加入作用域链中的，例如：with 或者 catch 语句。</p> <div class="warning custom-block"><p class="custom-block-title">注：</p> <p>with-objects 指的是 with 语句，产生的临时作用域对象；catch-clauses 指的是 catch 语句，如catch(e)，这会产生异常对象，导致作用域变更。</p></div> <br> <p>我们来看一个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> z <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
    <span class="token comment">// &quot;x&quot;和&quot;y&quot;是自由变量</span>
    <span class="token comment">// 会在作用域链的下一个对象中找到（函数”bar”的互动对象之后）</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>然后假设一个__parent__的属性，它是指向作用域链的下一个对象，使用__parent__的概念，我们可以把上面的代码演示成如下的情况：</p> <p><img src="/blog/assets/img/11.ac5901b8.png" alt></p> <br> <p>在代码执行过程中，如果使用 with 或者 catch 语句就会改变作用域链。而这些对象都是一些简单对象，他们也会有原型链。这样的话，作用域链会从两个维度来搜寻：</p> <ol><li><p>原本的作用域链;</p></li> <li><p>每一个链接点的作用域的链（如果这个链接点是有prototype的话）;</p></li></ol> <br> <p><strong>举例说明：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> w <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>

<span class="token comment">// 在 SpiderMonkey 全局对象里</span>
<span class="token comment">// 例如，全局上下文的变量对象是从&quot;Object.prototype&quot;继承到的</span>
<span class="token comment">// 所以我们可以得到“没有声明的全局变量”</span>
<span class="token comment">// 因为可以从原型链中获取</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 10</span>

<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// &quot;foo&quot; 是局部变量</span>
  <span class="token keyword">var</span> w <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

  <span class="token comment">// &quot;x&quot; 可以从&quot;Object.prototype&quot;得到，注意值是10哦</span>
  <span class="token comment">// 因为{z: 50}是从它那里继承的</span>
  <span class="token keyword">with</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>z<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 40, 10, 30, 50</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 在&quot;with&quot;对象从作用域链删除之后</span>
  <span class="token comment">// x 又可以从 foo 的上下文中得到了，注意这次值又回到了100</span>
  <span class="token comment">// w 也是局部变量</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// 100, 40</span>

  <span class="token comment">// 在浏览器里</span>
  <span class="token comment">// 我们可以通过如下语句来得到全局的w值</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 20</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>结构如下图所示。这表示，在我们去搜寻__parent__之前，首先会去__proto__的链接中：</p> <p><img src="/blog/assets/img/12.1ffd6efe.png" alt></p> <br> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>不是所有的全局对象都是由Object.prototype继承而来的。</p></div> <p>当一个上下文终止之后，其状态与自身将会被销毁(destroyed) ，同时内部函数将会从外部函数中返回。此外，这个返回的函数之后可能会在其他的上下文中被激活，这就涉及到闭包相关的知识点了，后续文章我们会介绍到。</p> <br> <h3 id="this指向"><a href="#this指向" aria-hidden="true" class="header-anchor">#</a> this指向</h3> <p><strong>this 是和执行的上下文环境息息相关的一个特殊对象。因此，它也可以称为上下文对象[context object]。</strong></p> <div class="warning custom-block"><p class="custom-block-title">重要</p> <p>任何对象都可以作为上下文的this值。通常，this 被错误地，描述为变量对象的属性。实际上，this 是执行上下文环境的一个属性，而不是某个变量对象的属性</p></div> <p>这个特点很重要，因为和变量不同，this是没有一个类似搜寻变量的过程。当你在代码中使用了this,这个 this的值就直接从执行的上下文中获取了，而不会从作用域链中搜寻。this的值只取决中进入上下文时的情况。</p> <br> <p>在global context(全局上下文)中，this 的值就是指全局这个对象，这就意味着，this值就是这个变量本身。在函数上下文中，this 会根据每次的函数调用而成为不同的值。例如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// &quot;foo&quot;函数里的alert没有改变</span>
<span class="token comment">// 但每次激活调用的时候this是不同的</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>

<span class="token comment">// 调用者激活 &quot;foo&quot;这个callee，并且提供&quot;this&quot;给这个callee</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                          <span class="token comment">// this 指向全局对象</span>
foo<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// foo.prototype</span>

<span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token punctuation">{</span> baz<span class="token punctuation">:</span> foo <span class="token punctuation">}</span><span class="token punctuation">;</span>

bar<span class="token punctuation">.</span><span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// this 指向bar</span>
<span class="token punctuation">(</span>bar<span class="token punctuation">.</span>baz<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// this 指向bar</span>
<span class="token punctuation">(</span>bar<span class="token punctuation">.</span>baz <span class="token operator">=</span> bar<span class="token punctuation">.</span>baz<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// this 指向全局对象</span>
<span class="token punctuation">(</span>bar<span class="token punctuation">.</span>baz<span class="token punctuation">,</span> bar<span class="token punctuation">.</span>baz<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 也是全局对象</span>
<span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">||</span> bar<span class="token punctuation">.</span>baz<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 也是全局对象</span>

<span class="token keyword">var</span> otherFoo <span class="token operator">=</span> bar<span class="token punctuation">.</span>baz<span class="token punctuation">;</span>
<span class="token function">otherFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment">// 还是全局对象</span>
</code></pre></div><p>如果要深入思考每一次函数调用中，this值的变化，后续文章会进行详细讨论。</p> <br> <br> <h2 id="示例"><a href="#示例" aria-hidden="true" class="header-anchor">#</a> 示例</h2> <p>文章的最后，我们来看一个示例，了解整个执行上下文在创建以及执行过程中的全过程：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;global scope&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">checkscope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;local scope&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> scope<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">checkscope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><br> <p>具体执行分析：</p> <ul><li><p><strong><code>第一步</code></strong>：进入预编译阶段，创建全局执行上下文，全局上下文被压入执行上下文栈；</p> <div class="language-js extra-class"><pre class="language-js"><code>ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
  globalContext
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>第二步</code></strong>：初始化全局上下文环境（初始化变量对象、作用域链，确定 this 指向），将函数体赋值给变量 checkscope；</p> <div class="language-js extra-class"><pre class="language-js"><code>globalContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token punctuation">[</span>global<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    scope<span class="token punctuation">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    <span class="token function-variable function">checkscope</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;local scope&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">return</span> scope<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  Scope<span class="token punctuation">:</span> <span class="token punctuation">[</span>globalContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">this</span><span class="token punctuation">:</span> globalContext<span class="token punctuation">.</span><span class="token constant">VO</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>第三步</code></strong>：进入执行阶段，将 &quot;global scope&quot; 赋值给变量 scope，并开始执行 checkscope()；</p> <div class="language-js extra-class"><pre class="language-js"><code>globalContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token punctuation">[</span>global<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    scope<span class="token punctuation">:</span> <span class="token string">&quot;global scope&quot;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">checkscope</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;local scope&quot;</span><span class="token punctuation">;</span>
      <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">return</span> scope<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  Scope<span class="token punctuation">:</span> <span class="token punctuation">[</span>globalContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">this</span><span class="token punctuation">:</span> globalContext<span class="token punctuation">.</span><span class="token constant">VO</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>第四步</code></strong>：执行 checkscope 函数前，先进入预编译阶段，开始创建 checkscope 函数执行上下文，checkscope 函数执行上下文被压入执行上下文栈；</p> <div class="language-js extra-class"><pre class="language-js"><code>ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
  checkscopeContext<span class="token punctuation">,</span>
  globalContext
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>第五步</code></strong>：初始化 checkscope 函数执行上下文环境（初始化活动对象、作用域链，确定 this 指向），将函数体赋值给变量 f；</p> <div class="language-js extra-class"><pre class="language-js"><code>checkscopeContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">AO</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    arguments<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      length<span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    scope<span class="token punctuation">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    <span class="token function-variable function">f</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> scope <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  Scope<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token constant">AO</span><span class="token punctuation">,</span> globalContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">this</span><span class="token punctuation">:</span> global
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>第六步</code></strong>：进入执行阶段，开始执行 checkscope 函数，将 &quot;local scope&quot; 赋值给变量 scope，并开始执行 f()；</p> <div class="language-js extra-class"><pre class="language-js"><code>checkscopeContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">AO</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    arguments<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      length<span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    scope<span class="token punctuation">:</span> <span class="token string">&quot;local scope&quot;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">f</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> scope <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  Scope<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token constant">AO</span><span class="token punctuation">,</span> globalContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">this</span><span class="token punctuation">:</span> global
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>第七步</code></strong>：执行 f 函数前，先进入预编译阶段，开始创建 f 函数执行上下文，f 函数执行上下文被压入执行上下文栈；</p> <div class="language-js extra-class"><pre class="language-js"><code>ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
  fContext<span class="token punctuation">,</span>
  checkscopeContext<span class="token punctuation">,</span>
  globalContext
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>第八步</code></strong>：和之前的步骤相同，初始化 f 函数执行上下文环境；</p> <div class="language-js extra-class"><pre class="language-js"><code>fContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">AO</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      arguments<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          length<span class="token punctuation">:</span> <span class="token number">0</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  Scope<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token constant">AO</span><span class="token punctuation">,</span> checkscopeContext<span class="token punctuation">.</span><span class="token constant">AO</span><span class="token punctuation">,</span> globalContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">this</span><span class="token punctuation">:</span> global
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>第九步</code></strong>：开始执行 f 函数，沿着作用域链查找 scope 值，返回 scope 值；</p> <div class="language-js extra-class"><pre class="language-js"><code>ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
  fContext<span class="token punctuation">,</span>
  checkscopeContext<span class="token punctuation">,</span>
  globalContext
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>第十步</code></strong>：f 函数执行完毕，f 函数上下文从执行上下文栈中弹出；</p> <div class="language-js extra-class"><pre class="language-js"><code>ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
  checkscopeContext<span class="token punctuation">,</span>
  globalContext
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <br> <ul><li><p><strong><code>第十一步</code></strong>：checkscope 函数执行完毕，checkscope 执行上下文从执行上下文栈中弹出；</p> <div class="language-js extra-class"><pre class="language-js"><code>ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
  globalContext
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间: </span> <span class="time">2019-7-7 21:55:38</span></div></div> <!----> </div> <!----></div></div>
    <script src="/blog/assets/js/app.39887082.js" defer></script><script src="/blog/assets/js/12.f5e2c995.js" defer></script><script src="/blog/assets/js/66.a0b0e699.js" defer></script>
  </body>
</html>
